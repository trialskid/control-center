{% extends "base.html" %}
{% load humanize %}
{% block title %}Dashboard - Control Center{% endblock %}
{% block content %}
<div class="mb-6">
    <h1 class="text-2xl font-bold text-white">Dashboard</h1>
    <p class="text-sm text-gray-400 mt-1">Your command center</p>
</div>

<!-- Liquidity Alerts -->
{% include "partials/_alerts.html" %}

<!-- Cash Flow Summary Bar -->
<div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
    <div class="bg-gray-800 rounded-lg border border-gray-700 p-4">
        <p class="text-xs text-gray-400 uppercase tracking-wide">Actual Inflows</p>
        <p class="text-xl font-bold text-green-400 mt-1">${{ cashflow.actual_inflows|default:"0"|floatformat:0|intcomma }}</p>
    </div>
    <div class="bg-gray-800 rounded-lg border border-gray-700 p-4">
        <p class="text-xs text-gray-400 uppercase tracking-wide">Actual Outflows</p>
        <p class="text-xl font-bold text-red-400 mt-1">${{ cashflow.actual_outflows|default:"0"|floatformat:0|intcomma }}</p>
    </div>
    <div class="bg-gray-800 rounded-lg border border-gray-700 p-4">
        <p class="text-xs text-gray-400 uppercase tracking-wide">Projected In</p>
        <p class="text-xl font-bold text-green-300 mt-1">${{ cashflow.projected_inflows|default:"0"|floatformat:0|intcomma }}</p>
    </div>
    <div class="bg-gray-800 rounded-lg border border-gray-700 p-4">
        <p class="text-xs text-gray-400 uppercase tracking-wide">Projected Out</p>
        <p class="text-xl font-bold text-red-300 mt-1">${{ cashflow.projected_outflows|default:"0"|floatformat:0|intcomma }}</p>
    </div>
</div>

<!-- 2x2 Grid -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    {% include "dashboard/partials/_overdue_tasks.html" %}
    {% include "dashboard/partials/_active_legal_matters.html" %}
    {% include "dashboard/partials/_recent_activity.html" %}
    {% include "dashboard/partials/_stale_followups.html" %}
</div>

<!-- Upcoming Tasks -->
{% if upcoming_tasks %}
<div class="mt-6 bg-gray-800 rounded-lg border border-gray-700">
    <div class="px-4 py-3 border-b border-gray-700">
        <h2 class="text-sm font-semibold text-gray-200 uppercase tracking-wide">Upcoming Tasks (Next 14 Days)</h2>
    </div>
    <div class="divide-y divide-gray-700">
        {% for task in upcoming_tasks %}
        <a href="{{ task.get_absolute_url }}" class="flex items-center justify-between px-4 py-3 hover:bg-gray-750 transition-colors">
            <div>
                <p class="text-sm text-gray-200">{{ task.title }}</p>
                {% if task.related_stakeholder %}<p class="text-xs text-gray-400">{{ task.related_stakeholder }}</p>{% endif %}
            </div>
            <div class="text-right">
                <span class="text-xs px-2 py-0.5 rounded-full
                    {% if task.priority == 'critical' %}bg-red-900/50 text-red-300
                    {% elif task.priority == 'high' %}bg-orange-900/50 text-orange-300
                    {% elif task.priority == 'medium' %}bg-yellow-900/50 text-yellow-300
                    {% else %}bg-gray-700 text-gray-300{% endif %}">{{ task.get_priority_display }}</span>
                <p class="text-xs text-gray-400 mt-1">{{ task.due_date|date:"M j" }}</p>
            </div>
        </a>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}
